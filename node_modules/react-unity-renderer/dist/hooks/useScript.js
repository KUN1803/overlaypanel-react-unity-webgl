"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useScript = void 0;
/*
 * This is an enhanced version of useScript by "useHooks.com":
 * https://usehooks.com/useScript/
 */
var react_1 = require("react");
var useScript = function (src) {
    var _a = react_1.useState(src), source = _a[0], setSource = _a[1];
    var _b = react_1.useState(src ? 'loading' : 'unloaded'), scriptState = _b[0], setScriptState = _b[1];
    // on state change
    react_1.useEffect(function () {
        var script = document.querySelector("script[src=\"" + source + "\"]");
        if (!source) {
            setScriptState('unloaded');
        }
        else if (source && !script) {
            // if script is not in DOM yet, add it
            script = document.createElement('script');
            script.src = source;
            script.async = true;
            // callback on script load/error to update the hooks state
            var setStateCallback = function (event) {
                setScriptState(event.type === 'load'
                    ? 'active'
                    : 'error');
            };
            script.addEventListener('load', setStateCallback);
            script.addEventListener('error', setStateCallback);
            // attach the script to the DOM
            document.body.appendChild(script);
        }
        return function () {
            if (script)
                script.remove();
        };
    }, [source]);
    return [scriptState, function (sourceUrl) { return setSource(sourceUrl); }];
};
exports.useScript = useScript;
//# sourceMappingURL=useScript.js.map